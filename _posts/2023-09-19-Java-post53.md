---
layout: post
title:  "[포스코DX|Spring|7주] 30일차 수업"
date:   2023-09-19
categories: Java
---

# 포스코DX X 비트교육센터 6기 - Spring

---

## AOP

cross concern 횡단 관심을 바깥으로 들어내서 없애버리는 것.

- aoptest -> jar 파일로 만듦.
- 폴더 구조

![image](https://github.com/talkingOrange/talkingOrange.github.io/assets/88815795/7892b145-fa58-4707-9adc-9d4f165f9370)


- pom.xml

```java
<project xmlns="http://maven.apache.org/POM/4.0.0"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd">
	<modelVersion>4.0.0</modelVersion>
	<parent>
		<groupId>com.poscodx</groupId>
		<artifactId>spring-practices</artifactId>
		<version>0.0.1-SNAPSHOT</version>
	</parent>
	<artifactId>aoptest</artifactId>


	<properties>
		<project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
		<project.build.outputEncoding>UTF-8</project.build.outputEncoding>
		<maven.compiler.source>17</maven.compiler.source>
		<maven.compiler.target>17</maven.compiler.target>
		<org-springframework-version>5.3.25</org-springframework-version>
	</properties>

	<dependencies>
		<!-- spring mvc -->
		<dependency>
			<groupId>org.springframework</groupId>
			<artifactId>spring-context</artifactId>
			<version>${org-springframework-version}</version>
		</dependency>

		<!-- spring aspect -->
		<dependency>
			<groupId>org.springframework</groupId>
			<artifactId>spring-aspects</artifactId>
			<version>${org-springframework-version}</version>
		</dependency>
	</dependencies>

	<build>
		<finalName>aoptest</finalName>
	</build>
</project>
```

- applicationContext.xml

```java
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:aop="http://www.springframework.org/schema/aop"
       xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd
        http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee.xsd
        http://www.springframework.org/schema/lang http://www.springframework.org/schema/lang/spring-lang.xsd
        http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd
        http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd
        http://www.springframework.org/schema/task http://www.springframework.org/schema/task/spring-task.xsd">
<!-- auto proxy -->
<aop:aspectj-autoproxy />

	<context:annotation-config />
	<context:component-scan base-package="service, aspect">
		<context:include-filter type="annotation" expression="org.springframework.stereotype.Repository" />
		<context:include-filter type="annotation" expression="org.springframework.stereotype.Service" />
		<context:include-filter type="annotation" expression="org.springframework.stereotype.Component" />			
	</context:component-scan>
</beans>
```


- mainApp.java

```java
package main;

import org.springframework.context.ApplicationContext;
import org.springframework.context.support.AbstractApplicationContext;
import org.springframework.context.support.ClassPathXmlApplicationContext;

import service.ProductService;
import vo.ProductVo;

public class MainApp {
	public static void main(String[] args) {
		ApplicationContext ac = new ClassPathXmlApplicationContext("config/applicationContext.xml");
		
		ProductService ps = ac.getBean(ProductService.class);
		ProductVo vo = ps.find("TV");
		System.out.println(vo);
		
		((AbstractApplicationContext)ac).close();
		
		
	}
}

```


- productService

```java
package service;

import org.springframework.stereotype.Service;

import vo.ProductVo;

@Service
public class ProductService {

	public ProductVo find(String keyword) {
		ProductVo vo = new ProductVo(keyword);
		return vo;
	}
}

```

- ProductVo.java

```java
package vo;

public class ProductVo {
	private String name;
	
	public ProductVo(String name) {
		this.name = name;
	}

	@Override
	public String toString() {
		return "ProductVo [name=" + name + "]";
	}
	
	
}

```

- 결과

![image](https://github.com/talkingOrange/talkingOrange.github.io/assets/88815795/5d76e889-8d9c-4732-afc0-f7ef18e68d44)



- MyAspect.java의 추가

![image](https://github.com/talkingOrange/talkingOrange.github.io/assets/88815795/cee96afb-e107-4243-8a24-f3931d757f0c)

```java
package com.poscodx.aoptest.aspect;

import org.aspectj.lang.annotation.After;
import org.aspectj.lang.annotation.Aspect;
import org.aspectj.lang.annotation.Before;
import org.springframework.stereotype.Component;

@Component
@Aspect
public class MyAspect {
   
   @Before("execution(public com.poscodx.aoptest.vo.ProductVo com.poscodx.aoptest.service.ProductService.find(String))") //해당 함수가 실행되기전 실행해라!!
   public void adviceBefore() {
      System.out.println("----before advice----");
   }
   
   //접근 지시자는 생략 가능!
   @After("execution(com.poscodx.aoptest.vo.ProductVo com.poscodx.aoptest.service.ProductService.find(String))") //해당 함수가 실행되기전 실행해라!!
   public void adviceAfter() {
      System.out.println("----before advice----");
   }
}
```


- Spring Exception의 catch 문을 없애기 위해 사용하는 스타일

[ 첫 번째 ]

```java
//ProductService.java
package com.poscodx.aoptest.service;

import org.springframework.stereotype.Service;

import com.poscodx.aoptest.vo.ProductVo;

@Service
public class ProductService {

	public ProductVo find(String keyword) {
		ProductVo vo = new ProductVo(keyword);
		if( 1 - 1 == 0) {
			throw new RuntimeException("ProductService.find() Exception");
		}
		return vo;
	}
}

```

- main 실행

![image](https://github.com/talkingOrange/talkingOrange.github.io/assets/88815795/a2c66339-eb6d-48ca-b64e-f33baea3dfff)


[ 두 번째 ]
